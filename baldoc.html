<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Tue Oct 30 04:08:05 2018 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>The bal manual</title>

</head>
<body>

<h1 align="center">The bal manual</h1>

<a href="#1. Introduction">1. Introduction</a><br>
<a href="#2. Data types">2. Data types</a><br>
<a href="#3. Interactive functions">3. Interactive functions</a><br>
<a href="#3.1. Functions to add accounts and transactions">3.1. Functions to add accounts and transactions</a><br>
<a href="#3.2. Functions to edit accounts transactions">3.2. Functions to edit accounts transactions</a><br>
<a href="#3.3. Functions to print account and transaction information">3.3. Functions to print account and transaction information</a><br>
<a href="#3.4. Utility functions">3.4. Utility functions</a><br>
<a href="#4. Creating interactive functions">4. Creating interactive functions</a><br>
<a href="#5. Non-interactive functions">5. Non-interactive functions</a><br>
<a href="#6. FreeBSD Documentation License">6. FreeBSD Documentation License</a><br>

<hr>


<p><tt>bal</tt> is an extensible tool for keeping accounts
in order and studying past spending habits. This manual
gives a basic overview of the package and provides a full
reference manual to the various Guile Scheme functions
<tt>bal</tt> exposes.</p>

<p style="margin-top: 1em">Copyright (c) 2018 Zach Flynn.
Permission is granted to copy, distribute and/or modify this
document under the terms of the FreeBSD Documentation
License. A copy of the license is included in the section
entitled &quot;FreeBSD Documentation License&quot;.</p>

<h2>1. Introduction
<a name="1. Introduction"></a>
</h2>


<p style="margin-top: 1em"><b>bal</b> is an extensible
personal account manager, recording all the good, bad,
terrible, and mundane financial decisions you make and
helping you plan for the future. It is extensible because
its prompt is simply a Guile Scheme interpreter (where you
don&rsquo;t enclose the outer S-expression in parenthesis)
so it can execute arbitrary code on your transactions. It
has a built-in function for making Scheme functions
interactive that allows you to specify that the function
takes &quot;accounts&quot; or &quot;transactions&quot;
(which are simply Scheme lists with certain values) as
arguments and have the user select the account or
transaction from a menu.</p>

<p style="margin-top: 1em">The main interface is a command
prompt interface using the Scheme interpreter with some
built-in C functions that can be called from Scheme, but of
course, other interfaces could be developed by running
Scheme code at the interpreter.</p>

<p style="margin-top: 1em">This document describes basic
usage of <b>bal</b> using the built-in functions and gives a
full reference manual to the functions that are available
from Scheme to aid in writing your own code to automate
whatever tasks your financial life needs automated (for
example, a script to update the value of your stock or
mutual fund holdings by fetching the latest prices from the
internet).</p>

<h2>2. Data types
<a name="2. Data types"></a>
</h2>


<p style="margin-top: 1em">There are two data types in
<tt>bal</tt> of interest to programming it in Scheme: the
account and the transaction. This brief section discusses
the key concepts.</p>

<p style="margin-top: 1em"><i>Transaction and Account
Numbers.</i> Each transaction has a &quot;coordinate&quot;
given by the pair (cons account_number transaction_number).
Transactions and accounts are numbered starting at 0,
accounts are numbered in the order in which they were
created, and transactions are in chronological order by day.
Transaction number is the element number in the list
returned by <tt>(bal/get-all-transactions
account_name).</tt> Account number is the element number of
the account in the list returned by
<tt>(bal/get-all-accounts).</tt></p>

<p style="margin-top: 1em"><i>Accounts in Scheme.</i> When
Scheme functions return accounts they do so as a
four-element list,</p>

<p style="margin-left:10%;"><tt>(account_name account_type
number_of_transactions opening_balance)</tt></p>

<p style="margin-top: 1em"><i>Transactions in Scheme.</i>
When Scheme functions return transactions they do so as a
five-element list,</p>

<p style="margin-left:10%;"><tt>(description amount year
month day)</tt></p>

<h2>3. Interactive functions
<a name="3. Interactive functions"></a>
</h2>


<p style="margin-top: 1em">The command prompt is a Scheme
interpreter except that the outer-most S expression should
not be enclosed in parenthesis to save on typing. This
section describes the &quot;interactive functions&quot;
&mdash; functions that can be entered without arguments at
the prompt and then prompt the user for options &mdash;
available in <tt>bal.</tt></p>

<h3>3.1. Functions to add accounts and transactions
<a name="3.1. Functions to add accounts and transactions"></a>
</h3>



<p style="margin-left:10%; margin-top: 1em"><tt>(aa)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Add account.
Prompts for the name of the account, the kind of account it
is, and its opening balance.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(at)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Add
transaction. Prompts for the account to add the transaction
to, the amount of the transaction, a description of the
transaction, and when the transaction was made.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(t)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Add a transfer
between accounts. This is the most commonly-used command
because most financial events involve a transaction taking
money from one account and another transaction putting money
in the other. Prompts for the &quot;from&quot; and
&quot;to&quot; accounts, the amount of the transfer, a
description of the transaction, and when the transaction
took place.</p>

<h3>3.2. Functions to edit accounts transactions
<a name="3.2. Functions to edit accounts transactions"></a>
</h3>



<p style="margin-left:10%; margin-top: 1em"><tt>(ea)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Rename
account.</p>

<p style="margin-left:10%; margin-top: 1em"><tt>(et
[n])</tt></p>

<p style="margin-left:10%; margin-top: 1em">Edit
transaction. Prompts for the transaction to edit and all the
various properties of a transaction as if you were adding
the transaction anew. Entering nothing for a cateogry leaves
it unchanged. Optionally, include a different number of
transactions than the default to show when prompting for the
transaction (any transaction number can be entered even if
it is not displayed in the menu; the menu is just a
convenience).</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(da)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Delete
account.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(dt)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Delete
transaction.</p>

<h3>3.3. Functions to print account and transaction information
<a name="3.3. Functions to print account and transaction information"></a>
</h3>



<p style="margin-left:10%; margin-top: 1em"><tt>(la)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Lists all
accounts and their present and future balances.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(lt)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Lists the most
recent transaction in the current account. The number of
transactions to list is set by the Scheme variable
<tt>bal/number-to-quick-list</tt> so entering the following
at the prompt will change the number to list: <tt>set!
bal/number-to-quick-list NUM</tt></p>


<p style="margin-left:10%; margin-top: 1em"><tt>(ltn)</tt></p>

<p style="margin-left:10%; margin-top: 1em">The same as
<tt>(lt)</tt> except that it prompts for the number to list
and for the account to list the transactions from.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(ltbd)</tt></p>

<p style="margin-left:10%; margin-top: 1em">list
transactions in current account by day, prompting for the
first and last day to show.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bt)</tt></p>

<p style="margin-left:10%; margin-top: 1em">List total
balances in Expense, Income, Asset, and Liability accounts
and total Worth (Asset+Liability) versus Opening Balances
for all accounts.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(re)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Search for
transactions in the current account with a description that
matches a regular expression (prompted for).</p>

<h3>3.4. Utility functions
<a name="3.4. Utility functions"></a>
</h3>



<p style="margin-left:10%; margin-top: 1em"><tt>(sa)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Set current
account.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(ca)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Print current
account.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(w)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Write account
to file (prompted for name).</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(r)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Read saved
accounts from file.</p>

<p style="margin-left:10%; margin-top: 1em"><tt>(p
X)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Print the
Scheme object <tt>X.</tt></p>


<p style="margin-left:10%; margin-top: 1em"><tt>(v)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Print out the
<tt>bal</tt> version.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(sd)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Set current
day. <tt>(bt)</tt> and <tt>(la)</tt> will now total
transactions before and after this day.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(cd)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Print current
day in YYYY-MM-DD format.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(q)</tt></p>

<p style="margin-left:10%; margin-top: 1em">quit
<tt>bal</tt></p>

<h2>4. Creating interactive functions
<a name="4. Creating interactive functions"></a>
</h2>


<p style="margin-top: 1em">To create interactive functions,
use the Scheme function</p>

<pre style="margin-top: 1em">                  (bal/call func options)</pre>


<p style="margin-top: 1em">func is a string giving the
function name to call, and <tt>options</tt> is a list of
pairs containing (in its car) the prompt to give the user
and the type of the argument to require (in its cdr). The
following types are recognized in <tt>bal.</tt></p>

<p style="margin-left:10%; margin-top: 1em">string &mdash;
the option will be treated as a string in the function
call</p>

<p style="margin-left:10%; margin-top: 1em">account &mdash;
the option will be to select an <i>existing</i> account (the
name of which will be passed as a string to the function
call).</p>


<p style="margin-left:10%; margin-top: 1em">current_account
&mdash; the name of the current account will be passed as a
string (the user will not see a prompt for this option).</p>

<p style="margin-left:10%; margin-top: 1em">type &mdash;
prompt to select an account type (Asset, Liability, Income,
Expense).</p>

<p style="margin-left:10%; margin-top: 1em">transaction
&mdash; prompt to select an existing transaction, passed as
a pair giving the account number and the transaction
number.</p>

<p style="margin-left:10%; margin-top: 1em">daystr &mdash;
prompt to select a year, a month, and a day, passed as a
string in YYYY-MM-DD format.</p>

<p style="margin-left:10%; margin-top: 1em">day &mdash;
prompt to select a year, a month, and a day, passed as a
list with three integers in the following order: day, month,
year.</p>

<p style="margin-left:10%; margin-top: 1em">other &mdash;
passed exactly as entered (the user can enter any Scheme
expression and it will just be copied as an argument to the
function).</p>

<p style="margin-top: 1em"><b>Example.</b> The interactive
function <tt>(t)</tt> creates a transfer from one account to
another account. It is written in the following way,</p>

<pre style="margin-left:10%; margin-top: 1em">(define t
  (lambda ()
    (bal/call &quot;bal/t&quot;
              (list
               (cons &quot;To Account&quot; &quot;account&quot;)
               (cons &quot;From Account&quot; &quot;account&quot;)
               (cons &quot;Amount&quot; &quot;real&quot;)
               (cons &quot;Description&quot; &quot;string&quot;)
               (cons &quot;Day&quot; &quot;daystr&quot;)))))</pre>


<p style="margin-top: 1em">bal/t is also a Scheme function.
It adds a negative transactions to the &quot;from
account&quot; and a positive transaction to the &quot;to
account&quot;. Its source is,</p>

<pre style="margin-left:10%; margin-top: 1em">(define bal/t
  (lambda (to-account from-account amount desc day)
    (let ((to-type (list-ref (bal/get-account to-account) 1))
          (from-type (list-ref (bal/get-account from-account) 1)))
      (bal/at to-account amount desc day)
      (bal/at from-account (* -1 amount) desc day))))</pre>


<h2>5. Non-interactive functions
<a name="5. Non-interactive functions"></a>
</h2>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/at
account amount desc day)</tt></p>

<p style="margin-left:10%; margin-top: 1em">adds a
transaction to an account where <tt>account</tt> is the name
of the account, <tt>amount</tt> is the amount of the
transaction, <tt>desc</tt> is a string describing the
transaction, and <tt>day</tt> gives the day of the
transaction in YYYY-MM-DD format.</p>

<p style="margin-left:10%; margin-top: 1em"><tt>(bal/aa
name type ob)</tt></p>

<p style="margin-left:10%; margin-top: 1em">adds a new
account with name <i>name</i> and <i>type</i> is one of
(&quot;expense&quot;, &quot;income&quot;, &quot;asset&quot;,
&quot;liability&quot;) and gives the type of the account and
<i>ob</i> gives the opening balance for the account.</p>

<p style="margin-left:10%; margin-top: 1em"><tt>(bal/et
(cons account_number transaction_number))</tt></p>

<p style="margin-left:10%; margin-top: 1em">edits
transaction located at <tt>account_number</tt> and
<tt>transaction_number</tt> with interactive prompts for
what to modify. To programmatically modify transactions,
delete and add the transaction with <tt>bal/dt</tt> and
<tt>bal/at.</tt></p>

<p style="margin-left:10%; margin-top: 1em"><tt>(bal/ea
current_account_name new_name)</tt></p>

<p style="margin-left:10%; margin-top: 1em">rename account
from <tt>current_account_name</tt> to <tt>new_name.</tt></p>

<p style="margin-left:10%; margin-top: 1em"><tt>(bal/da
account_name)</tt></p>

<p style="margin-left:10%; margin-top: 1em">delete account
with name <tt>account_name.</tt></p>

<p style="margin-left:10%; margin-top: 1em"><tt>(bal/dt
(cons account_number transaction_number))</tt></p>

<p style="margin-left:10%; margin-top: 1em">delete
transaction.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-current-account)</tt></p>

<p style="margin-left:10%; margin-top: 1em">returns a
string with the name of the current account.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-number-of-accounts)</tt></p>

<p style="margin-left:10%; margin-top: 1em">return the
number of accounts.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-transactions
account_name how_many)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Return</p>

<p style="margin-left:10%; margin-top: 1em">of the latest
transactions from account with</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-all-transactions
account_name)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Return all
transactions from <tt>account_name.</tt> Each transaction is
a five element list with elements (description, amount,
year, month, day).</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-transactions-by-regex
account_name regex)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Return all
transactions from <tt>account_name</tt> with descriptions
that match <tt>regex.</tt></p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-account
account_name)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Returns the
account with name <tt>account_name,</tt> a four element
list,
(name,type_of_account,number_transactions,opening_balance).</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-all-accounts)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Returns a list
of all the accounts where each account is a four element
list,
(name,type_of_account,number_transactions,opening_balance).</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-transaction-by-location
account_num transact_num)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Returns the
transaction at account number and transaction number, a
five-element list (description, amount, year, month,
day).</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-account-by-location
account_num)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Return account
corresponding to <tt>acocunt_num.</tt></p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-transactions-by-day
account_name first_day last_day)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Return a list
of transactions between the <tt>first_day</tt> and
<tt>last_day</tt> within the account with name
days<tt>account_name.</tt>Both</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/total-account
account_name)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Returns the sum
of all transactions within the account with name,
<tt>account_name.</tt></p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/total-all-accounts)</tt>
<br>
Returns a list of pairs where each pair has in its
<tt>car</tt> the name of the account and in its <tt>cdr</tt>
the sum of all transactions within that account.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/total-by-account-type)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Returns a list
of pairs which have in their <tt>car</tt> the name of the
account type (Income, Expense, Asset, Liability),
&quot;Worth&quot; (Assets + Liabilities), and
&quot;Balances&quot; (for total opening balances) and in its
<tt>cdr</tt> the total sum of transactions within each
account type.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/set-account
account_name)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Sets the
current account to <tt>account_name.</tt></p>

<p style="margin-left:10%; margin-top: 1em"><tt>(bal/write
file)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Writes all
accounts to <tt>file.</tt></p>

<p style="margin-left:10%; margin-top: 1em"><tt>(bal/read
file)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Read in
accounts from <tt>file.</tt></p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-current-file)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Returns the
name of the current default save file.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/set-select-transact-number
num)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Sets number of
transactions to show when selecting a transaction to
<tt>num.</tt> On any transaction selection screen you can
enter any transaction number whether it is displayed.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/v)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Returns a
string giving the version of <tt>bal.</tt></p>

<p style="margin-left:10%; margin-top: 1em"><tt>(bal/t
to_account from_account amount desc day)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Transfers from
<tt>from_account</tt> to <tt>to_account</tt> a transaction
in <tt>amount</tt> with description <tt>desc</tt> on day (in
YYYY-MM-DD format) <tt>day.</tt></p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/set-current-day
(list day month year))</tt></p>

<p style="margin-left:10%; margin-top: 1em">Sets the
current day to the year, month, and day provided as
arguments. The function returns the list passed to it,
unaltered.</p>


<p style="margin-left:10%; margin-top: 1em"><tt>(bal/get-current-day)</tt></p>

<p style="margin-left:10%; margin-top: 1em">Returns a three
element list, <tt>(list day month year),</tt> giving the
current day, month, and year.</p>

<h2>6. FreeBSD Documentation License
<a name="6. FreeBSD Documentation License"></a>
</h2>


<p style="margin-top: 1em">Copyright 1994-2018 The FreeBSD
Project. All rights reserved.</p>

<p style="margin-top: 1em">Redistribution and use in source
(Groff) and &rsquo;compiled&rsquo; forms (SGML, HTML, PDF,
PostScript, RTF and so forth) with or without modification,
are permitted provided that the following conditions are
met:</p>

<p style="margin-top: 1em">Redistributions of source code
(Groff) must retain the above copyright notice, this list of
conditions and the following disclaimer as the first lines
of this file unmodified.</p>

<p style="margin-top: 1em">Redistributions in compiled form
(transformed to other DTDs, converted to PDF, PostScript,
RTF and other formats) must reproduce the above copyright
notice, this list of conditions and the following disclaimer
in the documentation and/or other materials provided with
the distribution.</p>

<p style="margin-top: 1em">THIS DOCUMENTATION IS PROVIDED
BY ZACH FLYNN &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL ZACH FLYNN BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
DOCUMENTATION, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.</p>
<hr>
</body>
</html>
